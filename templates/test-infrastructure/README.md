# Test Infrastructure Template

This directory contains the complete testing infrastructure for AI Factory projects.

## What's Included

### Configuration Files
- `vitest.config.js` - Unit test configuration
- `playwright.config.js` - E2E test configuration
- `package.json.template` - npm scripts for testing

### Scripts
- `scripts/validate.js` - Full validation runner

### Test Templates
- `src/__tests__/example.test.js` - Unit test template
- `tests/integration/example.test.js` - Integration test template (create as needed)
- `e2e/example.spec.js` - E2E test template (create as needed)

## How to Use

### 1. Copy to New Project

```bash
# Copy all files to new project
cp -r templates/test-infrastructure/* projects/YOUR_PROJECT/

# Rename package.json template
mv projects/YOUR_PROJECT/package.json.template projects/YOUR_PROJECT/package.json

# Update project name in package.json
sed -i 's/PROJECT_NAME/your-project-name/g' projects/YOUR_PROJECT/package.json
```

### 2. Install Dependencies

```bash
cd projects/YOUR_PROJECT
npm install
```

### 3. Write Tests FIRST

```bash
# Start test watch mode
npm run test:watch

# Write failing tests in src/__tests__/
# Then write code to make them pass
```

### 4. Run Validations

```bash
# Run all tests
npm run test

# Run with coverage
npm run test:coverage

# Run integration tests
npm run test:integration

# Run E2E tests
npm run test:e2e

# Run ALL validations
npm run validate
```

## Test-Driven Development Workflow

1. **Write Test** (that fails)
2. **Run Test** (see it fail ❌)
3. **Write Code** (minimum to pass)
4. **Run Test** (see it pass ✅)
5. **Refactor** (keep tests green)

## Enforcement

The following npm scripts are hooked to enforce testing:

- `prepackage` - Runs `npm run validate` before packaging
- `prebuild:prod` - Runs `npm run validate` before production build

**Result**: Cannot build/deploy with failing tests!

## Coverage Requirements

- **Minimum**: 80% for core logic
- **Critical**: 100% for critical paths (auth, payments, data handling)

Check coverage:
```bash
npm run test:coverage
```

## Manual Playtest Checklist

Even with automated tests, complete this checklist before delivery:

- [ ] Build succeeds without errors
- [ ] All automated tests pass
- [ ] UI/UX functions as expected
- [ ] No console errors
- [ ] Performance acceptable (no lag)
- [ ] Works in target browser/environment

## Integration with AI Factory

This template is automatically applied to:
- All new projects generated by AI Factory
- Enforced by supervisor/quality_check.go
- Validated before marking tasks complete

## Support

See ZERO_BUG_WORKFLOW.md in AI Factory root for complete documentation.
